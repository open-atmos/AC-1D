

<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Model Run Examples and Output Notebook &#8212; Aerosol-Cloud Column Model (AC-1D)  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/cloud.css?v=f9ae72be" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to the Aerosol-Cloud Column Model (AC-1D) documentation!" href="index.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="index.html" title="Welcome to the Aerosol-Cloud Column Model (AC-1D) documentation!"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="index.html">Aerosol-Cloud Column Model (AC-1D)  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Model Run Examples and Output Notebook</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="Model-Run-Examples-and-Output-Notebook">
<h1>Model Run Examples and Output Notebook<a class="headerlink" href="#Model-Run-Examples-and-Output-Notebook" title="Link to this heading">¶</a></h1>
<p>Let’s start with two basic model simulations; one using <a class="reference external" href="https://pubs.rsc.org/en/content/articlehtml/2013/fd/c3fd00035d">ABIFM</a>, and the other using a singular approach (by default, the <a class="reference external" href="https://www.pnas.org/content/107/25/11217">DeMott et al. (2010)</a> size-dependent parametrization). The model input, simulation, and output are received, performed, and provided in SI units, so when specifying the input, we should remain consistent with this approach (by default). Each model simulation is
initialized with a single monomodal aerosol population with arbitrary parameter values (diameter of <span class="math notranslate nohighlight">\(10^{-6}\)</span> <span class="math notranslate nohighlight">\(m\)</span> (1 micrometer); <span class="math notranslate nohighlight">\(N_{aer}\ =\ 2\cdot 10^{3}\ m^{-3}\)</span>). Throughout the simulation, we use a single profile from the LES output (3 <span class="math notranslate nohighlight">\(h\)</span>; after the simulation reached a steady-state).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from init_model import ci_model
import numpy as np

# ABIFM
model_abifm = ci_model(use_ABIFM=True,
                       deplete_entrained=False,
                       aer_info=[{&quot;name&quot;: &quot;Desert_Dust&quot;,
                                  &quot;n_init_max&quot;: 2.0e3,
                                  &quot;psd&quot;: {&quot;type&quot;: &quot;mono&quot;,
                                          &quot;diam&quot;: 1.0e-6},
                                  &quot;nucleus_type&quot;: &quot;Desert Dust&quot;}],
                       t_harvest=3600*3)

# Singular
model_singular = ci_model(use_ABIFM=False,
                          deplete_entrained=False,
                          aer_info=[{&quot;name&quot;: &quot;Desert_Dust&quot;,
                                     &quot;n_init_max&quot;: 2.0e3,
                                     &quot;psd&quot;: {&quot;type&quot;: &quot;mono&quot;,
                                             &quot;diam&quot;: 1.0e-6},
                                     &quot;nucleus_type&quot;: &quot;Desert Dust&quot;}],
                          t_harvest=3600*3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model initalization done! Total processing time = 0.875653 s
10% of model run completed. Elapsed time: 0.58 s.
20% of model run completed. Elapsed time: 1.16 s.
30% of model run completed. Elapsed time: 1.74 s.
40% of model run completed. Elapsed time: 2.32 s.
50% of model run completed. Elapsed time: 2.90 s.
60% of model run completed. Elapsed time: 3.48 s.
70% of model run completed. Elapsed time: 4.06 s.
80% of model run completed. Elapsed time: 4.63 s.
90% of model run completed. Elapsed time: 5.21 s.

Model run finished! Total run time = 5.808107 s
Model run time stats:
Process: activation_aer: 0.77 s (13.33% of of total time)
Process: entrainment_aer: 0.50 s (8.66% of of total time)
Process: mixing_aer: 0.61 s (10.58% of of total time)
Process: sedimentation_ice: 0.50 s (8.54% of of total time)
Process: mixing_ice: 0.48 s (8.27% of of total time)
Process: data_allocation: 2.91 s (50.09% of of total time)


Model initalization done! Total processing time = 0.771569 s
10% of model run completed. Elapsed time: 0.52 s.
20% of model run completed. Elapsed time: 1.04 s.
30% of model run completed. Elapsed time: 1.56 s.
40% of model run completed. Elapsed time: 2.08 s.
50% of model run completed. Elapsed time: 2.60 s.
60% of model run completed. Elapsed time: 3.12 s.
70% of model run completed. Elapsed time: 3.63 s.
80% of model run completed. Elapsed time: 4.15 s.
90% of model run completed. Elapsed time: 4.67 s.

Model run finished! Total run time = 5.235843 s
Model run time stats:
Process: activation_aer: 1.11 s (21.20% of of total time)
Process: entrainment_aer: 0.52 s (9.96% of of total time)
Process: mixing_aer: 0.67 s (12.87% of of total time)
Process: sedimentation_ice: 0.46 s (8.74% of of total time)
Process: mixing_ice: 0.45 s (8.67% of of total time)
Process: data_allocation: 1.96 s (37.53% of of total time)


</pre></div></div>
</div>
<p>Now, we can use the internal <em>ci_model</em> object (or xarray) to generate some plots, in the example below nucleated ice time-height curtains and profile mean time series.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cb = {}
fig, ax = model_abifm.generate_figure(subplot_shape=(2,2))
ax[0,0], cb[&quot;sub0&quot;] = model_abifm.plot_curtain(ax=ax[0,0], field_to_plot=&quot;Ni_nuc&quot;, vmin=1e-1, vmax=1e2, log_plot=True, title=&quot;ABIFM (desert dust)&quot;)
ax[0,1], cb[&quot;sub1&quot;] = model_singular.plot_curtain(ax=ax[0,1], field_to_plot=&quot;Ni_nuc&quot;, vmin=1e-1, vmax=1e2, log_plot=True, title=&quot;Singular (DeMott et al., 2010)&quot;)
ax[1,0] = model_abifm.plot_tseries(ax=ax[1,0], field_to_plot=&quot;Ni_nuc&quot;, grid=True, yscale=&quot;log&quot;, ylim=[1e-1, 3e1], title=&quot;ABIFM (desert dust)&quot;)
ax[1,1] = model_singular.plot_tseries(ax=ax[1,1], field_to_plot=&quot;Ni_nuc&quot;, grid=True, yscale=&quot;log&quot;, ylim=[1e-1, 3e1], title=&quot;Singular (DeMott et al., 2010)&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_4_0.png" src="_images/Example_4_0.png" />
</div>
</div>
<p>To some, it is more convenient to specify the aerosol input parameters (diameters and concentrations) in non-SI units such as <span class="math notranslate nohighlight">\(\mu m\)</span> and <span class="math notranslate nohighlight">\(L^{-1}\)</span>. If one wishes to use this feature, then the input concentration and/or diameter units need to be specified using the ‘input_conc_units’ and ‘input_diam_units’ keywords, respectively, as demonstrated below. In this case, unit conversion is performed during model initialization using the <a class="reference external" href="https://pint.readthedocs.io/en/stable/">pint</a>
unit conversion Python package (see <a class="reference external" href="https://github.com/hgrecco/pint/blob/master/pint/default_en.txt">pint’s documentation</a> for full list of acceptable string formats and units), but the model still runs and provides output in SI units (a message describing the conversion procedures is printed on the screen). Note that the output plots below are identical to those shown above because model initialization is practically identical.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from init_model import ci_model
import numpy as np

# ABIFM
model_abifm_nonSI_in = ci_model(use_ABIFM=True,
                                aer_info=[{&quot;name&quot;: &quot;Desert_Dust&quot;,
                                           &quot;n_init_max&quot;: 2.,  # L^-1
                                           &quot;psd&quot;: {&quot;type&quot;: &quot;mono&quot;,
                                                   &quot;diam&quot;: 1.},  # um
                                           &quot;nucleus_type&quot;: &quot;Desert Dust&quot;}],
                                input_conc_units=&quot;L^{-1}&quot;,
                                input_diam_units=&quot;um&quot;,
                                t_harvest=3600*3)

# Singular
model_singular_nonSI_in = ci_model(use_ABIFM=False,
                                   aer_info=[{&quot;name&quot;: &quot;Desert_Dust&quot;,
                                              &quot;n_init_max&quot;: 2.,  # L^-1
                                              &quot;psd&quot;: {&quot;type&quot;: &quot;mono&quot;,
                                                      &quot;diam&quot;: 1.},     # um
                                              &quot;nucleus_type&quot;: &quot;Desert Dust&quot;}],
                                   input_conc_units=&quot;L^{-1}&quot;,
                                   input_diam_units=&quot;um&quot;,
                                   t_harvest=3600*3)

# Plotting
_, ax = model_abifm_nonSI_in.generate_figure(subplot_shape=(2,2))
model_abifm_nonSI_in.plot_curtain(ax=ax[0,0], field_to_plot=&quot;Ni_nuc&quot;, vmin=1e-1, vmax=1e2, log_plot=True, title=&quot;ABIFM (desert dust)&quot;)
model_singular_nonSI_in.plot_curtain(ax=ax[0,1], field_to_plot=&quot;Ni_nuc&quot;, vmin=1e-1, vmax=1e2, log_plot=True, title=&quot;Singular (DeMott et al., 2010)&quot;)
model_abifm_nonSI_in.plot_tseries(ax=ax[1,0], field_to_plot=&quot;Ni_nuc&quot;, grid=True, yscale=&quot;log&quot;, ylim=[1e-1, 3e1], title=&quot;ABIFM (desert dust)&quot;)
model_singular_nonSI_in.plot_tseries(ax=ax[1,1], field_to_plot=&quot;Ni_nuc&quot;, grid=True, yscale=&quot;log&quot;, ylim=[1e-1, 3e1], title=&quot;Singular (DeMott et al., 2010)&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;diam&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
Model initalization done! Total processing time = 0.771855 s
10% of model run completed. Elapsed time: 0.58 s.
20% of model run completed. Elapsed time: 1.16 s.
30% of model run completed. Elapsed time: 1.75 s.
40% of model run completed. Elapsed time: 2.35 s.
50% of model run completed. Elapsed time: 2.94 s.
60% of model run completed. Elapsed time: 3.53 s.
70% of model run completed. Elapsed time: 4.12 s.
80% of model run completed. Elapsed time: 4.70 s.
90% of model run completed. Elapsed time: 5.28 s.

Model run finished! Total run time = 5.891086 s
Model run time stats:
Process: activation_aer: 0.79 s (13.44% of of total time)
Process: entrainment_aer: 0.51 s (8.66% of of total time)
Process: mixing_aer: 0.62 s (10.58% of of total time)
Process: sedimentation_ice: 0.50 s (8.55% of of total time)
Process: mixing_ice: 0.48 s (8.16% of of total time)
Process: data_allocation: 2.95 s (50.11% of of total time)


&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;diam&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
Model initalization done! Total processing time = 0.776144 s
10% of model run completed. Elapsed time: 0.53 s.
20% of model run completed. Elapsed time: 1.06 s.
30% of model run completed. Elapsed time: 1.59 s.
40% of model run completed. Elapsed time: 2.13 s.
50% of model run completed. Elapsed time: 2.65 s.
60% of model run completed. Elapsed time: 3.18 s.
70% of model run completed. Elapsed time: 3.70 s.
80% of model run completed. Elapsed time: 4.22 s.
90% of model run completed. Elapsed time: 4.74 s.

Model run finished! Total run time = 5.297949 s
Model run time stats:
Process: activation_aer: 1.12 s (21.18% of of total time)
Process: entrainment_aer: 0.53 s (10.00% of of total time)
Process: mixing_aer: 0.68 s (12.75% of of total time)
Process: sedimentation_ice: 0.47 s (8.80% of of total time)
Process: mixing_ice: 0.46 s (8.64% of of total time)
Process: data_allocation: 2.00 s (37.74% of of total time)


</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fd92e0e8190&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_6_2.png" src="_images/Example_6_2.png" />
</div>
</div>
<p>It is occasionally also more convenient to examine and/or plot the model output data in units such as <span class="math notranslate nohighlight">\(L^{-1}\)</span> for concentrations or <span class="math notranslate nohighlight">\(cm^{-2} s^{-1}\)</span> for Jhet. We can easily convert all of the ci_model object’s output fields using the ci_model class internal methods, which also take advantage of ‘pint’. Moreover, we can change the coordinates (height, time, diameter, temperature) associated with the different output variables to more convenient units as well, for example, time in
hours. When called, each of these methods informs us about the unit conversions that were made and the fields on which they were applied (as also performed in the ‘_swap_diam_dim_to_from_um’, ‘_swap_height_dim_to_from_km’, and ‘_swap_T_dim_to_from_C’ internal unit conversion methods). Note that we changed the vmin, vmax, and ylim input parameters accordingly when calling the internal plotting methods (these ranges are set automatically if not explicitly specified).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>model_abifm._convert_quantity_units(&quot;L^{-1}&quot;)
model_singular._convert_quantity_units(&quot;L^{-1}&quot;)
model_abifm._convert_quantity_units(&quot;cm^{-2} s^{-1}&quot;)
model_abifm._swap_time_dim_to_from_hr()
model_singular._swap_time_dim_to_from_hr()

cb = {}
xticks = np.linspace(0, 2, 2)
fig, ax = model_abifm.generate_figure(subplot_shape=(2,2))
ax[0,0], cb[&quot;sub0&quot;] = model_abifm.plot_curtain(ax=ax[0,0], field_to_plot=&quot;Ni_nuc&quot;, vmin=1e-4, vmax=1e-1, log_plot=True, title=&quot;ABIFM&quot;)
ax[0,1], cb[&quot;sub1&quot;] = model_singular.plot_curtain(ax=ax[0,1], field_to_plot=&quot;Ni_nuc&quot;, vmin=1e-4, vmax=1e-1, log_plot=True, title=&quot;singular&quot;)
ax[1,0] = model_abifm.plot_tseries(ax=ax[1,0], field_to_plot=&quot;Ni_nuc&quot;, grid=True, yscale=&quot;log&quot;, ylim=[1e-4, 3e-2], title=&quot;ABIFM&quot;)
ax[1,1] = model_singular.plot_tseries(ax=ax[1,1], field_to_plot=&quot;Ni_nuc&quot;, grid=True, yscale=&quot;log&quot;, ylim=[1e-4, 3e-2], title=&quot;singular&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The units of &#39;Ni&#39; converted from $m^{-3}$ to L^{-1}
The units of &#39;Ni_nuc&#39; converted from $m^{-3}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Desert_Dust&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Desert_Dust&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;Ni&#39; converted from $m^{-3}$ to L^{-1}
The units of &#39;Ni_nuc&#39; converted from $m^{-3}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Desert_Dust&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;inp&#39; in the &#39;Desert_Dust&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;Jhet&#39; in the &#39;Desert_Dust&#39; popolation converted from $m^{-2} s^{-1}$ to cm^{-2} s^{-1}
Converting time dimension units from seconds to hours
Converting time dimension units from seconds to hours
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_8_1.png" src="_images/Example_8_1.png" />
</div>
</div>
<p>Let’s see the output fields in our model i/o xr.Dataset. Note that all concentration fields do not have now the default SI units of <span class="math notranslate nohighlight">\(m^{-3}\)</span> but <span class="math notranslate nohighlight">\(L^{-1}\)</span> instead, and that the ‘time_h’ coordinate representing the simulation time in hours serves as one of the ci_model object xr.Dataset’s dimensions (designated by the <strong>bold</strong> font).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>model_abifm.ds
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (height: 43, time_h: 2161)
Coordinates:
  * height       (height) float32 5.208 15.62 26.04 36.46 ... 421.9 432.3 442.7
    time         (time_h) int64 0 10 20 30 40 ... 21560 21570 21580 21590 21600
    height_km    (height) float32 0.005208 0.01562 0.02604 ... 0.4323 0.4427
  * time_h       (time_h) float64 0.0 0.002778 0.005556 ... 5.994 5.997 6.0
Data variables: (12/16)
    delta_z      (height) float32 &lt;Quantity([10.416666  10.416668  10.416668 ...
    RH           (height, time_h) float64 &lt;Quantity([[0.83984634 0.83984634 0...
    ql           (height, time_h) float64 &lt;Quantity([[3.33709838e-10 3.337098...
    T            (height, time_h) float64 &lt;Quantity([[256.79629517 256.796295...
    Ni           (height, time_h) float64 &lt;Quantity([[0.02163903 0.02163903 0...
    prec         (height, time_h) float64 &lt;Quantity([[1.01465179e-04 1.014651...
    ...           ...
    mixing_mask  (height, time_h) bool True True True True ... True True True
    v_f_ice      (time_h) float64 &lt;Quantity([0.3 0.3 0.3 ... 0.3 0.3 0.3], &#x27;m...
    delta_aw     (height, time_h) float64 &lt;Quantity([[-1.27699807e-02 -1.2769...
    S_ice        (height, time_h) float64 &lt;Quantity([[0.98502259 0.98502259 0...
    Ni_nuc       (height, time_h) float64 &lt;Quantity([[0.00000000e+00 5.731655...
    nuc_rate     (height, time_h) float64 &lt;Quantity([[0.00000000e+00 1.443187...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2c1f3926-4739-4004-a2af-609029375f23' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2c1f3926-4739-4004-a2af-609029375f23' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>height</span>: 43</li><li><span class='xr-has-index'>time_h</span>: 2161</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d1564568-52cf-4368-94de-43232efc7ebb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d1564568-52cf-4368-94de-43232efc7ebb' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>height</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>5.208 15.62 26.04 ... 432.3 442.7</div><input id='attrs-8b55d524-33b8-4c8f-aec3-6840ac7d51af' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8b55d524-33b8-4c8f-aec3-6840ac7d51af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57039240-c994-4d21-9bd9-98138912f6da' class='xr-var-data-in' type='checkbox'><label for='data-57039240-c994-4d21-9bd9-98138912f6da' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><div class='xr-var-data'><pre>array([  5.208333,  15.625   ,  26.041668,  36.458336,  46.875   ,  57.291668,
        67.708336,  78.125   ,  88.54167 ,  98.958336, 109.375   , 119.79167 ,
       130.20834 , 140.625   , 151.04167 , 161.45834 , 171.875   , 182.29167 ,
       192.70834 , 203.125   , 213.54167 , 223.95834 , 234.375   , 244.79167 ,
       255.20834 , 265.625   , 276.0417  , 286.45834 , 296.875   , 307.2917  ,
       317.70834 , 328.125   , 338.5417  , 348.95834 , 359.375   , 369.7917  ,
       380.20834 , 390.625   , 401.0417  , 411.45834 , 421.875   , 432.2917  ,
       442.70834 ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 10 20 30 ... 21580 21590 21600</div><input id='attrs-7edf3203-e6e4-477a-8f39-b097f1a14c79' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7edf3203-e6e4-477a-8f39-b097f1a14c79' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d63eff81-c3bd-4361-95b3-f54bc39120dc' class='xr-var-data-in' type='checkbox'><label for='data-d63eff81-c3bd-4361-95b3-f54bc39120dc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd></dl></div><div class='xr-var-data'><pre>array([    0,    10,    20, ..., 21580, 21590, 21600])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height_km</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.005208 0.01562 ... 0.4323 0.4427</div><input id='attrs-fe4c0b85-ea40-45d5-a00c-68089eb429d2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fe4c0b85-ea40-45d5-a00c-68089eb429d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ff14723-b0b6-4d4b-a5e7-47417b108a83' class='xr-var-data-in' type='checkbox'><label for='data-4ff14723-b0b6-4d4b-a5e7-47417b108a83' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$km$</dd></dl></div><div class='xr-var-data'><pre>array([0.00520833, 0.015625  , 0.02604167, 0.03645834, 0.046875  ,
       0.05729167, 0.06770834, 0.078125  , 0.08854167, 0.09895834,
       0.109375  , 0.11979167, 0.13020834, 0.140625  , 0.15104167,
       0.16145834, 0.171875  , 0.18229167, 0.19270834, 0.203125  ,
       0.21354167, 0.22395834, 0.234375  , 0.24479167, 0.25520834,
       0.265625  , 0.2760417 , 0.28645834, 0.296875  , 0.3072917 ,
       0.31770834, 0.328125  , 0.3385417 , 0.34895834, 0.359375  ,
       0.3697917 , 0.38020834, 0.390625  , 0.4010417 , 0.41145834,
       0.421875  , 0.4322917 , 0.44270834], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time_h</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.002778 0.005556 ... 5.997 6.0</div><input id='attrs-9e9b8875-81ac-486b-aad1-48257d3256c3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9e9b8875-81ac-486b-aad1-48257d3256c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-974349b5-ed06-431f-9793-7460a3bc4751' class='xr-var-data-in' type='checkbox'><label for='data-974349b5-ed06-431f-9793-7460a3bc4751' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$h$</dd></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 2.777778e-03, 5.555556e-03, ..., 5.994444e+00,
       5.997222e+00, 6.000000e+00])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0cb1e8cd-d42a-4457-9d73-d0a97d8a8f49' class='xr-section-summary-in' type='checkbox'  ><label for='section-0cb1e8cd-d42a-4457-9d73-d0a97d8a8f49' class='xr-section-summary' >Data variables: <span>(16)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>delta_z</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>&lt;Quantity([10.416666  10.416668 ...</div><input id='attrs-44436323-61a3-47dd-b90a-2b52bfad17c1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-44436323-61a3-47dd-b90a-2b52bfad17c1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b073ae9-c201-450e-9b24-cf1bcfdc4ad0' class='xr-var-data-in' type='checkbox'><label for='data-1b073ae9-c201-450e-9b24-cf1bcfdc4ad0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[10.416666030883789 10.416667938232422 10.416667938232422<br> 10.416664123535156 10.416667938232422 10.416667938232422<br> 10.416664123535156 10.416671752929688 10.416664123535156<br> 10.416664123535156 10.416671752929688 10.416671752929688<br> 10.416656494140625 10.416671752929688 10.416671752929688<br> 10.416656494140625 10.416671752929688 10.416671752929688<br> 10.416656494140625 10.416671752929688 10.416671752929688<br> 10.416656494140625 10.416671752929688 10.416671752929688<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>RH</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.83984634 0.8398463...</div><input id='attrs-d8ddf777-73a8-45cb-aea6-321dab72577f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d8ddf777-73a8-45cb-aea6-321dab72577f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c6bcd2f-a168-4600-91c7-ba96d466330a' class='xr-var-data-in' type='checkbox'><label for='data-6c6bcd2f-a168-4600-91c7-ba96d466330a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.8398463439941406 0.8398463439941406 0.8398463439941406 ...<br>  0.8398463439941406 0.8398463439941406 0.8398463439941406]<br> [0.8453170776367188 0.8453170776367188 0.8453170776367188 ...<br>  0.8453170776367188 0.8453170776367188 0.8453170776367188]<br> [0.8506898498535156 0.8506898498535156 0.8506898498535156 ...<br>  0.8506898498535156 0.8506898498535156 0.8506898498535156]<br> ...<br> [0.995068359375 0.995068359375 0.995068359375 ... 0.995068359375<br>  0.995068359375 0.995068359375]<br> [0.9571499633789062 0.9571499633789062 0.9571499633789062 ...<br>  0.9571499633789062 0.9571499633789062 0.9571499633789062]<br> [0.8328614807128907 0.8328614807128907 0.8328614807128907 ...<br>  0.8328614807128907 0.8328614807128907 0.8328614807128907]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>dimensionless</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ql</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[3.33709838e-10 3.337...</div><input id='attrs-3f3649df-5273-48fa-8dbc-aa749cd4fe5a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3f3649df-5273-48fa-8dbc-aa749cd4fe5a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f06a7855-9998-4526-947f-08eaf26dfd41' class='xr-var-data-in' type='checkbox'><label for='data-f06a7855-9998-4526-947f-08eaf26dfd41' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$kg\:kg^{-1}$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[3.337098375411074e-10 3.337098375411074e-10 3.337098375411074e-10 ...<br>  3.337098375411074e-10 3.337098375411074e-10 3.337098375411074e-10]<br> [3.854501995359527e-10 3.854501995359527e-10 3.854501995359527e-10 ...<br>  3.854501995359527e-10 3.854501995359527e-10 3.854501995359527e-10]<br> [4.3749548428451135e-10 4.3749548428451135e-10 4.3749548428451135e-10<br>  ... 4.3749548428451135e-10 4.3749548428451135e-10<br>  4.3749548428451135e-10]<br> ...<br> [4.012322460766882e-05 4.012322460766882e-05 4.012322460766882e-05 ...<br>  4.012322460766882e-05 4.012322460766882e-05 4.012322460766882e-05]<br> [1.334254557150416e-05 1.334254557150416e-05 1.334254557150416e-05 ...<br>  1.334254557150416e-05 1.334254557150416e-05 1.334254557150416e-05]<br> [1.1226213700865628e-06 1.1226213700865628e-06 1.1226213700865628e-06<br>  ... 1.1226213700865628e-06 1.1226213700865628e-06<br>  1.1226213700865628e-06]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>dimensionless</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>T</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[256.79629517 256.796...</div><input id='attrs-f4714b0d-a17f-42cc-b7b7-4bf917560306' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f4714b0d-a17f-42cc-b7b7-4bf917560306' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2830f99c-ff88-4063-a4de-500af0442c88' class='xr-var-data-in' type='checkbox'><label for='data-2830f99c-ff88-4063-a4de-500af0442c88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$K$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[256.7962951660156 256.7962951660156 256.7962951660156 ...<br>  256.7962951660156 256.7962951660156 256.7962951660156]<br> [256.68988037109375 256.68988037109375 256.68988037109375 ...<br>  256.68988037109375 256.68988037109375 256.68988037109375]<br> [256.5662841796875 256.5662841796875 256.5662841796875 ...<br>  256.5662841796875 256.5662841796875 256.5662841796875]<br> ...<br> [253.245361328125 253.245361328125 253.245361328125 ... 253.245361328125<br>  253.245361328125 253.245361328125]<br> [253.87742614746094 253.87742614746094 253.87742614746094 ...<br>  253.87742614746094 253.87742614746094 253.87742614746094]<br> [255.34278869628906 255.34278869628906 255.34278869628906 ...<br>  255.34278869628906 255.34278869628906 255.34278869628906]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>kelvin</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ni</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.02163903 0.0216390...</div><input id='attrs-3d9dcc58-e597-4332-8090-6bf0bd4ea476' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3d9dcc58-e597-4332-8090-6bf0bd4ea476' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a9854db-130f-4800-8ea8-31dc002b7341' class='xr-var-data-in' type='checkbox'><label for='data-8a9854db-130f-4800-8ea8-31dc002b7341' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.021639027181663554 0.021639027181663554 0.021639027181663554 ...<br>  0.021639027181663554 0.021639027181663554 0.021639027181663554]<br> [0.02199174559791573 0.02199174559791573 0.02199174559791573 ...<br>  0.02199174559791573 0.02199174559791573 0.02199174559791573]<br> [0.02232477345387452 0.02232477345387452 0.02232477345387452 ...<br>  0.02232477345387452 0.02232477345387452 0.02232477345387452]<br> ...<br> [0.004845116563956254 0.004845116563956254 0.004845116563956254 ...<br>  0.004845116563956254 0.004845116563956254 0.004845116563956254]<br> [0.0026504619654588173 0.0026504619654588173 0.0026504619654588173 ...<br>  0.0026504619654588173 0.0026504619654588173 0.0026504619654588173]<br> [0.0006756703214705341 0.0006756703214705341 0.0006756703214705341 ...<br>  0.0006756703214705341 0.0006756703214705341 0.0006756703214705341]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>prec</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[1.01465179e-04 1.014...</div><input id='attrs-4f58bef1-31eb-4d2f-99af-f7015d6e8c0e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4f58bef1-31eb-4d2f-99af-f7015d6e8c0e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c0ed8b7d-bb86-45ca-8863-2890fb49b32d' class='xr-var-data-in' type='checkbox'><label for='data-c0ed8b7d-bb86-45ca-8863-2890fb49b32d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$mm\:h^{-1}$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.00010146517888642848 0.00010146517888642848 0.00010146517888642848<br>  ... 0.00010146517888642848 0.00010146517888642848<br>  0.00010146517888642848]<br> [0.0001060415233951062 0.0001060415233951062 0.0001060415233951062 ...<br>  0.0001060415233951062 0.0001060415233951062 0.0001060415233951062]<br> [0.0001099545625038445 0.0001099545625038445 0.0001099545625038445 ...<br>  0.0001099545625038445 0.0001099545625038445 0.0001099545625038445]<br> ...<br> [1.9732851797016338e-06 1.9732851797016338e-06 1.9732851797016338e-06<br>  ... 1.9732851797016338e-06 1.9732851797016338e-06<br>  1.9732851797016338e-06]<br> [3.218117399228504e-07 3.218117399228504e-07 3.218117399228504e-07 ...<br>  3.218117399228504e-07 3.218117399228504e-07 3.218117399228504e-07]<br> [2.3266439441727016e-08 2.3266439441727016e-08 2.3266439441727016e-08<br>  ... 2.3266439441727016e-08 2.3266439441727016e-08<br>  2.3266439441727016e-08]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>millimeter/planck_constant</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>w_e_ent</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([0.0001 0.0001 0.0001 ...</div><input id='attrs-9263ec59-6495-4bf3-ab4c-55bfe0c9929b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9263ec59-6495-4bf3-ab4c-55bfe0c9929b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-343ee359-35f7-447d-876f-74f64d321344' class='xr-var-data-in' type='checkbox'><label for='data-343ee359-35f7-447d-876f-74f64d321344' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m/s$</dd><dt><span>long_name :</span></dt><dd>Cloud-top entrainment rate</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[0.0001 0.0001 0.0001 ... 0.0001 0.0001 0.0001]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter/second</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lowest_cbh</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([255.20834351 255.2083...</div><input id='attrs-f5d4032e-0d25-47ae-a44c-e091f57ffdec' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f5d4032e-0d25-47ae-a44c-e091f57ffdec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cf5a88b8-85b8-48e5-a943-c33387e0bc8f' class='xr-var-data-in' type='checkbox'><label for='data-cf5a88b8-85b8-48e5-a943-c33387e0bc8f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd><dt><span>long_name :</span></dt><dd>Lowest cloud base height</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[255.20834350585938 255.20834350585938 255.20834350585938 ...<br> 255.20834350585938 255.20834350585938 255.20834350585938]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lowest_cth</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([442.70834351 442.7083...</div><input id='attrs-0e5d30ab-3fdb-4a8d-b1bb-46d14ea085f1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e5d30ab-3fdb-4a8d-b1bb-46d14ea085f1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-61cb1542-f587-4604-9810-a07104a65417' class='xr-var-data-in' type='checkbox'><label for='data-61cb1542-f587-4604-9810-a07104a65417' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd><dt><span>long_name :</span></dt><dd>Lowest cloud top height</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[442.7083435058594 442.7083435058594 442.7083435058594 ...<br> 442.7083435058594 442.7083435058594 442.7083435058594]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tau_mix</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([1800. 1800. 1800. ......</div><input id='attrs-4840521a-1c89-4ed7-ac54-916cb1dbab7b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4840521a-1c89-4ed7-ac54-916cb1dbab7b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee7accd1-a9fc-4fa1-aa19-f6227e15eb88' class='xr-var-data-in' type='checkbox'><label for='data-ee7accd1-a9fc-4fa1-aa19-f6227e15eb88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd><dt><span>long_name :</span></dt><dd>Boundary-layer mixing time scale</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[1800.0 1800.0 1800.0 ... 1800.0 1800.0 1800.0]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>second</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>mixing_mask</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True True True ... True True True</div><input id='attrs-e835ad66-f54f-4dcb-b2a0-264201459978' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e835ad66-f54f-4dcb-b2a0-264201459978' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-68b3a4d7-a574-4c31-963f-22e9b1dabf4a' class='xr-var-data-in' type='checkbox'><label for='data-68b3a4d7-a574-4c31-963f-22e9b1dabf4a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Mixing-layer mask (True --&gt; mixed)</dd></dl></div><div class='xr-var-data'><pre>array([[ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True],
       ...,
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v_f_ice</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([0.3 0.3 0.3 ... 0.3 0...</div><input id='attrs-e5cd3b56-56c5-4543-b8d8-38865d2341d6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e5cd3b56-56c5-4543-b8d8-38865d2341d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e5c815f-c9c5-4449-be36-7e5103c0182a' class='xr-var-data-in' type='checkbox'><label for='data-0e5c815f-c9c5-4449-be36-7e5103c0182a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m/s$</dd><dt><span>long_name :</span></dt><dd>Number-weighted ice crystal fall velocity</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[0.3 0.3 0.3 ... 0.3 0.3 0.3]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter/second</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>delta_aw</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[-1.27699807e-02 -1.2...</div><input id='attrs-b7279c67-6bcd-4123-b93b-028321b71e00' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b7279c67-6bcd-4123-b93b-028321b71e00' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-861325ec-c75d-4aec-aa84-3adde7165c87' class='xr-var-data-in' type='checkbox'><label for='data-861325ec-c75d-4aec-aa84-3adde7165c87' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[-0.012769980702450168 -0.012769980702450168 -0.012769980702450168 ...<br>  -0.012769980702450168 -0.012769980702450168 -0.012769980702450168]<br> [-0.006411152509410822 -0.006411152509410822 -0.006411152509410822 ...<br>  -0.006411152509410822 -0.006411152509410822 -0.006411152509410822]<br> [-8.029448375412862e-06 -8.029448375412862e-06 -8.029448375412862e-06<br>  ... -8.029448375412862e-06 -8.029448375412862e-06<br>  -8.029448375412862e-06]<br> ...<br> [0.17159811647823164 0.17159811647823164 0.17159811647823164 ...<br>  0.17159811647823164 0.17159811647823164 0.17159811647823164]<br> [0.12856563355287665 0.12856563355287665 0.12856563355287665 ...<br>  0.12856563355287665 0.12856563355287665 0.12856563355287665]<br> [-0.0077025373431218735 -0.0077025373431218735 -0.0077025373431218735<br>  ... -0.0077025373431218735 -0.0077025373431218735<br>  -0.0077025373431218735]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>dimensionless</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>S_ice</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.98502259 0.9850225...</div><input id='attrs-e99e17ed-d9f8-4df0-9c4b-2b13e7a6ddd6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e99e17ed-d9f8-4df0-9c4b-2b13e7a6ddd6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-514cef5b-c265-40ae-bf41-eb9371863910' class='xr-var-data-in' type='checkbox'><label for='data-514cef5b-c265-40ae-bf41-eb9371863910' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.9850225941815102 0.9850225941815102 0.9850225941815102 ...<br>  0.9850225941815102 0.9850225941815102 0.9850225941815102]<br> [0.9924727720856324 0.9924727720856324 0.9924727720856324 ...<br>  0.9924727720856324 0.9924727720856324 0.9924727720856324]<br> [0.9999905613396122 0.9999905613396122 0.9999905613396122 ...<br>  0.9999905613396122 0.9999905613396122 0.9999905613396122]<br> ...<br> [1.2083841134011002 1.2083841134011002 1.2083841134011002 ...<br>  1.2083841134011002 1.2083841134011002 1.2083841134011002]<br> [1.1551630038427958 1.1551630038427958 1.1551630038427958 ...<br>  1.1551630038427958 1.1551630038427958 1.1551630038427958]<br> [0.9908364655425822 0.9908364655425822 0.9908364655425822 ...<br>  0.9908364655425822 0.9908364655425822 0.9908364655425822]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>dimensionless</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ni_nuc</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.00000000e+00 5.731...</div><input id='attrs-b942088a-cd15-42e3-b6bc-03998d2189c0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b942088a-cd15-42e3-b6bc-03998d2189c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e2d51843-003a-49a4-807f-01eb6cdc6370' class='xr-var-data-in' type='checkbox'><label for='data-e2d51843-003a-49a4-807f-01eb6cdc6370' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>Nucleated ice</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.0 5.731655432351244e-07 1.702053390113483e-06 ...<br>  0.013379263070027448 0.013378602641676078 0.013377942247589864]<br> [0.0 5.794562028598249e-07 1.7153509311804772e-06 ...<br>  0.013422500259325275 0.013421837701174123 0.013421175177397644]<br> [0.0 5.883695644282972e-07 1.7342554573451483e-06 ...<br>  0.013466546357572105 0.013465881629793598 0.013465216936501347]<br> ...<br> [0.0 0.00015834609841791316 0.00027577076916243405 ...<br>  0.0011480537082872162 0.0011479970492167457 0.0011479403930837633]<br> [0.0 1.6646601698007926e-05 2.9153439842496138e-05 ...<br>  0.0004657595134743796 0.0004657365257473407 0.0004657135392123094]<br> [0.0 5.704957895108654e-07 1.531536947064842e-06 ...<br>  0.00020994388940968455 0.00020993352740030196 0.000209923165928334]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nuc_rate</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.00000000e+00 1.443...</div><input id='attrs-355ba57a-34dc-4382-9280-56a7af0537d3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-355ba57a-34dc-4382-9280-56a7af0537d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9549b4f4-a0df-4f0f-a3d0-3480b62bf90c' class='xr-var-data-in' type='checkbox'><label for='data-9549b4f4-a0df-4f0f-a3d0-3480b62bf90c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m^{-3}\:s^{-1}$</dd><dt><span>long_name :</span></dt><dd>Ice nucleation rate</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.0 1.4431879859828648e-06 1.4431875735607143e-06 ...<br>  1.3085933022121984e-06 1.3085287274380553e-06 1.3084641560061186e-06]<br> [0.0 2.009831268492048e-06 2.009830688476684e-06 ...<br>  1.8223893327159834e-06 1.8222994037981256e-06 1.8222094795347332e-06]<br> [0.0 2.8054222832583814e-06 2.805421462546291e-06 ...<br>  2.5437796942918587e-06 2.5436541671330182e-06 2.5435286464711073e-06]<br> ...<br> [0.0 0.021366297104809067 0.021364021240063185 ... 0.019006934366148528<br>  0.019005996432273804 0.019005058547011244]<br> [0.0 0.0022716138051053847 0.002271587514436724 ...<br>  0.0020555445517873323 0.002055443117352536 0.0020553416881686102]<br> [0.0 1.8790938607599807e-06 1.8790933196972057e-06 ...<br>  1.7065519648291567e-06 1.7064693191295567e-06 1.706386677707965e-06]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/(meter<sup>3</sup> second)</td></tr></tbody></table></div></li></ul></div></li><li class='xr-section-item'><input id='section-23fd8023-f8fb-4a16-b846-b6d5abf7a1e5' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-23fd8023-f8fb-4a16-b846-b6d5abf7a1e5' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p>To examine the aerosol dataset we need to specify the population name (that way, we can call an xr.Dataset of each INP populationin, in the case of multiple INP populations). Let’s examine the difference in aerosol xr.Dataset fields for ABIFM and singular. Note that some differences in the singular output fields exist when using an INAS parameterization (e.g., using the ‘ND2012’ string representing the <a class="reference external" href="https://journals.ametsoc.org/view/journals/atsc/69/10/jas-d-11-0249.1.xml">Niemand et al.,
2012</a> parameterization). It should also be noted that nucleus type specification is not required in the singular approach).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>model_abifm.aer[&quot;Desert_Dust&quot;].ds
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (diam: 1, height: 43, time_h: 2161)
Coordinates:
  * diam       (diam) float64 1e-06
  * height     (height) float32 5.208 15.62 26.04 36.46 ... 421.9 432.3 442.7
    time       (time_h) int64 0 10 20 30 40 50 ... 21560 21570 21580 21590 21600
    height_km  (height) float32 0.005208 0.01562 0.02604 ... 0.4323 0.4427
  * time_h     (time_h) float64 0.0 0.002778 0.005556 ... 5.994 5.997 6.0
    diam_um    (diam) float64 1.0
Data variables:
    dn_dlogD   (diam) float64 &lt;Quantity([2.], &#x27;1 / liter&#x27;)&gt;
    surf_area  (diam) float64 &lt;Quantity([3.14159265e-12], &#x27;meter ** 2&#x27;)&gt;
    Jhet       (height, time_h) float64 &lt;Quantity([[2.29690502e-02 2.29690502...
    inp_pct    (height, time_h) float64 &lt;Quantity([[7.21593993e-07 7.21593993...
    n_aer      (height, time_h, diam) float64 &lt;Quantity([[[2.        ]   [1.9...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-95b72b57-40f7-43a8-8f25-eafd4f8bb8c0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-95b72b57-40f7-43a8-8f25-eafd4f8bb8c0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>diam</span>: 1</li><li><span class='xr-has-index'>height</span>: 43</li><li><span class='xr-has-index'>time_h</span>: 2161</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-de2fd1a4-84ae-49ce-87dd-6a9446f5e105' class='xr-section-summary-in' type='checkbox'  checked><label for='section-de2fd1a4-84ae-49ce-87dd-6a9446f5e105' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>diam</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e-06</div><input id='attrs-b57331e2-71f8-40c9-a617-c46b03f72d3a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b57331e2-71f8-40c9-a617-c46b03f72d3a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-99806035-6f56-4bd6-92ff-5ca09764b822' class='xr-var-data-in' type='checkbox'><label for='data-99806035-6f56-4bd6-92ff-5ca09764b822' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd><dt><span>long_name :</span></dt><dd>Bin-middle particle diameter</dd></dl></div><div class='xr-var-data'><pre>array([1.e-06])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>height</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>5.208 15.62 26.04 ... 432.3 442.7</div><input id='attrs-20514c70-b32c-4131-894b-fbc22f4f9542' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-20514c70-b32c-4131-894b-fbc22f4f9542' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8ce7c12a-dc0e-4cb5-9103-2d5198590144' class='xr-var-data-in' type='checkbox'><label for='data-8ce7c12a-dc0e-4cb5-9103-2d5198590144' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><div class='xr-var-data'><pre>array([  5.208333,  15.625   ,  26.041668,  36.458336,  46.875   ,  57.291668,
        67.708336,  78.125   ,  88.54167 ,  98.958336, 109.375   , 119.79167 ,
       130.20834 , 140.625   , 151.04167 , 161.45834 , 171.875   , 182.29167 ,
       192.70834 , 203.125   , 213.54167 , 223.95834 , 234.375   , 244.79167 ,
       255.20834 , 265.625   , 276.0417  , 286.45834 , 296.875   , 307.2917  ,
       317.70834 , 328.125   , 338.5417  , 348.95834 , 359.375   , 369.7917  ,
       380.20834 , 390.625   , 401.0417  , 411.45834 , 421.875   , 432.2917  ,
       442.70834 ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 10 20 30 ... 21580 21590 21600</div><input id='attrs-7a254e07-9d73-49a3-862a-c40522c8a062' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7a254e07-9d73-49a3-862a-c40522c8a062' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49cf0d80-bdab-4ce7-b83a-939547cadf5b' class='xr-var-data-in' type='checkbox'><label for='data-49cf0d80-bdab-4ce7-b83a-939547cadf5b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd></dl></div><div class='xr-var-data'><pre>array([    0,    10,    20, ..., 21580, 21590, 21600])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height_km</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.005208 0.01562 ... 0.4323 0.4427</div><input id='attrs-59b56a99-ff2c-456d-b9de-a093e9a95c56' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-59b56a99-ff2c-456d-b9de-a093e9a95c56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d40418f-6c9f-4fc5-a700-a5b526b6cb67' class='xr-var-data-in' type='checkbox'><label for='data-5d40418f-6c9f-4fc5-a700-a5b526b6cb67' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$km$</dd></dl></div><div class='xr-var-data'><pre>array([0.00520833, 0.015625  , 0.02604167, 0.03645834, 0.046875  ,
       0.05729167, 0.06770834, 0.078125  , 0.08854167, 0.09895834,
       0.109375  , 0.11979167, 0.13020834, 0.140625  , 0.15104167,
       0.16145834, 0.171875  , 0.18229167, 0.19270834, 0.203125  ,
       0.21354167, 0.22395834, 0.234375  , 0.24479167, 0.25520834,
       0.265625  , 0.2760417 , 0.28645834, 0.296875  , 0.3072917 ,
       0.31770834, 0.328125  , 0.3385417 , 0.34895834, 0.359375  ,
       0.3697917 , 0.38020834, 0.390625  , 0.4010417 , 0.41145834,
       0.421875  , 0.4322917 , 0.44270834], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time_h</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.002778 0.005556 ... 5.997 6.0</div><input id='attrs-c07572e1-a2d2-474a-85a0-f4bb1bc615ff' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c07572e1-a2d2-474a-85a0-f4bb1bc615ff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3da9dc2-135a-4b7b-b016-6cc728670a93' class='xr-var-data-in' type='checkbox'><label for='data-b3da9dc2-135a-4b7b-b016-6cc728670a93' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$h$</dd></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 2.777778e-03, 5.555556e-03, ..., 5.994444e+00,
       5.997222e+00, 6.000000e+00])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>diam_um</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-9a1b77ec-7115-4d88-a727-01f10ab914d2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9a1b77ec-7115-4d88-a727-01f10ab914d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e75c49bd-dbd6-4f8b-a940-8b0c38c50a79' class='xr-var-data-in' type='checkbox'><label for='data-e75c49bd-dbd6-4f8b-a940-8b0c38c50a79' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$\mu m$</dd></dl></div><div class='xr-var-data'><pre>array([1.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-537d388c-6b01-4e5f-a880-069ddf40d0b6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-537d388c-6b01-4e5f-a880-069ddf40d0b6' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>dn_dlogD</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([2.], &#x27;1 / liter&#x27;)&gt;</div><input id='attrs-781596be-e4be-4d2d-b9da-fa2fec38cbb8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-781596be-e4be-4d2d-b9da-fa2fec38cbb8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1c8fc3f2-5a82-4dcc-b444-178ded8034ad' class='xr-var-data-in' type='checkbox'><label for='data-1c8fc3f2-5a82-4dcc-b444-178ded8034ad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>Particle number concentration per diameter bin</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[2.0000000000000004]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>surf_area</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([3.14159265e-12], &#x27;met...</div><input id='attrs-6c841b21-b737-4588-8683-53303389906e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6c841b21-b737-4588-8683-53303389906e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1514b8a-2056-475c-914c-20b0af814b29' class='xr-var-data-in' type='checkbox'><label for='data-f1514b8a-2056-475c-914c-20b0af814b29' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m^2$</dd><dt><span>long_name :</span></dt><dd>Surface area per particle diameter</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[3.141592653589793e-12]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter<sup>2</sup></td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Jhet</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[2.29690502e-02 2.296...</div><input id='attrs-303da2d8-11b0-47cc-83db-7b1bb83dc7b1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-303da2d8-11b0-47cc-83db-7b1bb83dc7b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3b553c5f-ea6d-4f85-bd79-1af991e4164b' class='xr-var-data-in' type='checkbox'><label for='data-3b553c5f-ea6d-4f85-bd79-1af991e4164b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$cm^{-2} s^{-1}$</dd><dt><span>long_name :</span></dt><dd>Heterogeneous ice nucleation rate coefficient</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.02296905017800099 0.02296905017800099 0.02296905017800099 ...<br>  0.02296905017800099 0.02296905017800099 0.02296905017800099]<br> [0.03198745811611638 0.03198745811611638 0.03198745811611638 ...<br>  0.03198745811611638 0.03198745811611638 0.03198745811611638]<br> [0.044649682384072284 0.044649682384072284 0.044649682384072284 ...<br>  0.044649682384072284 0.044649682384072284 0.044649682384072284]<br> ...<br> [340.05517998004154 340.05517998004154 340.05517998004154 ...<br>  340.05517998004154 340.05517998004154 340.05517998004154]<br> [36.153856587831136 36.153856587831136 36.153856587831136 ...<br>  36.153856587831136 36.153856587831136 36.153856587831136]<br> [0.029906707647358463 0.029906707647358463 0.029906707647358463 ...<br>  0.029906707647358463 0.029906707647358463 0.029906707647358463]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/(centimeter<sup>2</sup> second)</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>inp_pct</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[7.21593993e-07 7.215...</div><input id='attrs-68148daa-1ff4-4c6b-92e0-e721c4f94932' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-68148daa-1ff4-4c6b-92e0-e721c4f94932' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85f7d3f5-86c5-483d-b07d-79fe49e3e4e9' class='xr-var-data-in' type='checkbox'><label for='data-85f7d3f5-86c5-483d-b07d-79fe49e3e4e9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$percent$</dd><dt><span>long_name :</span></dt><dd>INP percentage relative to total initial aerosol (using a time</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[7.215939929914324e-07 7.215939929914324e-07 7.215939929914324e-07 ...<br>  7.215939929914324e-07 7.215939929914324e-07 7.215939929914324e-07]<br> [1.0049156342460242e-06 1.0049156342460242e-06 1.0049156342460242e-06<br>  ... 1.0049156342460242e-06 1.0049156342460242e-06<br>  1.0049156342460242e-06]<br> [1.402711141629191e-06 1.402711141629191e-06 1.402711141629191e-06 ...<br>  1.402711141629191e-06 1.402711141629191e-06 1.402711141629191e-06]<br> ...<br> [0.010683148552404535 0.010683148552404535 0.010683148552404535 ...<br>  0.010683148552404535 0.010683148552404535 0.010683148552404535]<br> [0.0011358069025526924 0.0011358069025526924 0.0011358069025526924 ...<br>  0.0011358069025526924 0.0011358069025526924 0.0011358069025526924]<br> [9.395469303799904e-07 9.395469303799904e-07 9.395469303799904e-07 ...<br>  9.395469303799904e-07 9.395469303799904e-07 9.395469303799904e-07]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>percent</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>n_aer</span></div><div class='xr-var-dims'>(height, time_h, diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[[2.        ]   [1.99...</div><input id='attrs-8a373aa3-a54c-482a-a809-227b3e38de5f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8a373aa3-a54c-482a-a809-227b3e38de5f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cda01737-ae42-4833-8b06-f446d73a2986' class='xr-var-data-in' type='checkbox'><label for='data-cda01737-ae42-4833-8b06-f446d73a2986' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>aerosol number concentration per diameter bin</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[[2.0000000000000004]<br>  [1.999999428456786]<br>  [1.999998302962012]<br>  ...<br>  [1.8133863919978503]<br>  [1.8132969075612226]<br>  [1.8132074277560712]]<br><br> [[2.0000000000000004]<br>  [1.9999994228218332]<br>  [1.9999982917234138]<br>  ...<br>  [1.8133854641095073]<br>  [1.8132959797186508]<br>  [1.8132064999592685]]<br><br> [[2.0000000000000004]<br>  [1.9999994149101226]<br>  [1.9999982759439487]<br>  ...<br>  [1.8133841613168267]<br>  [1.8132946769902354]<br>  [1.8132051972951146]]<br><br> ...<br><br> [[2.0000000000000004]<br>  [1.9997869668539463]<br>  [1.9995745827307776]<br>  ...<br>  [1.7790631983673009]<br>  [1.7789754072766912]<br>  [1.7788876207361852]]<br><br> [[2.0000000000000004]<br>  [1.9999768528712045]<br>  [1.9999532774722113]<br>  ...<br>  [1.8096765504180234]<br>  [1.8095872489850968]<br>  [1.809497952174974]]<br><br> [[2.0000000000000004]<br>  [1.999999424123738]<br>  [1.9999982943749672]<br>  ...<br>  [1.8162683139621274]<br>  [1.8161803551610078]<br>  [1.816092400912933]]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li></ul></div></li><li class='xr-section-item'><input id='section-09d2681d-28c8-4844-b0f6-c3216f65bc76' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-09d2681d-28c8-4844-b0f6-c3216f65bc76' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>model_singular.aer[&quot;Desert_Dust&quot;].ds
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (T: 46, diam: 1, height: 43, time_h: 2161)
Coordinates:
  * T          (T) float64 253.0 253.1 253.2 253.3 ... 266.5 267.3 268.1 269.0
  * height     (height) float32 5.208 15.62 26.04 36.46 ... 421.9 432.3 442.7
    time       (time_h) int64 0 10 20 30 40 50 ... 21560 21570 21580 21590 21600
  * diam       (diam) float64 1e-06
    T_C        (T) float64 -20.15 -20.05 -19.94 -19.83 ... -5.851 -5.036 -4.18
    height_km  (height) float32 0.005208 0.01562 0.02604 ... 0.4323 0.4427
  * time_h     (time_h) float64 0.0 0.002778 0.005556 ... 5.994 5.997 6.0
    diam_um    (diam) float64 1.0
Data variables:
    dn_dlogD   (diam) float64 &lt;Quantity([2.], &#x27;1 / liter&#x27;)&gt;
    surf_area  (diam) float64 &lt;Quantity([3.14159265e-12], &#x27;meter ** 2&#x27;)&gt;
    ns_raw     (height, time_h) float64 &lt;Quantity([[0.00000000e+00 0.00000000...
    inp        (height, time_h, T) float64 &lt;Quantity([[[7.16660250e-06 1.1711...
    inp_pct    (height, time_h) float64 &lt;Quantity([[0.         0.         0. ...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5f745b6b-d2aa-4475-ae62-845c94f7d796' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5f745b6b-d2aa-4475-ae62-845c94f7d796' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>T</span>: 46</li><li><span class='xr-has-index'>diam</span>: 1</li><li><span class='xr-has-index'>height</span>: 43</li><li><span class='xr-has-index'>time_h</span>: 2161</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b0fe59e5-0811-471d-ac8f-2c6ed647fe65' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b0fe59e5-0811-471d-ac8f-2c6ed647fe65' class='xr-section-summary' >Coordinates: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>T</span></div><div class='xr-var-dims'>(T)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>253.0 253.1 253.2 ... 268.1 269.0</div><input id='attrs-fb10b66d-625b-403e-a7ff-556c20f85bbb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fb10b66d-625b-403e-a7ff-556c20f85bbb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f3faf57a-cd74-4bb2-a96e-30ef59351ae1' class='xr-var-data-in' type='checkbox'><label for='data-f3faf57a-cd74-4bb2-a96e-30ef59351ae1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$K$</dd></dl></div><div class='xr-var-data'><pre>array([253.      , 253.1     , 253.205   , 253.31525 , 253.431012, 253.552563,
       253.680191, 253.814201, 253.954911, 254.102656, 254.257789, 254.420679,
       254.591713, 254.771298, 254.959863, 255.157856, 255.365749, 255.584037,
       255.813238, 256.0539  , 256.306595, 256.571925, 256.850521, 257.143048,
       257.4502  , 257.77271 , 258.111345, 258.466913, 258.840258, 259.232271,
       259.643885, 260.076079, 260.529883, 261.006377, 261.506696, 262.032031,
       262.583632, 263.162814, 263.770955, 264.409502, 265.079977, 265.783976,
       266.523175, 267.299334, 268.114301, 268.970016])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>height</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>5.208 15.62 26.04 ... 432.3 442.7</div><input id='attrs-6bad4c4f-463b-49ae-98a0-4eeae254ec4a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6bad4c4f-463b-49ae-98a0-4eeae254ec4a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bd99313f-64e0-484c-ac33-5d10ba90ed85' class='xr-var-data-in' type='checkbox'><label for='data-bd99313f-64e0-484c-ac33-5d10ba90ed85' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><div class='xr-var-data'><pre>array([  5.208333,  15.625   ,  26.041668,  36.458336,  46.875   ,  57.291668,
        67.708336,  78.125   ,  88.54167 ,  98.958336, 109.375   , 119.79167 ,
       130.20834 , 140.625   , 151.04167 , 161.45834 , 171.875   , 182.29167 ,
       192.70834 , 203.125   , 213.54167 , 223.95834 , 234.375   , 244.79167 ,
       255.20834 , 265.625   , 276.0417  , 286.45834 , 296.875   , 307.2917  ,
       317.70834 , 328.125   , 338.5417  , 348.95834 , 359.375   , 369.7917  ,
       380.20834 , 390.625   , 401.0417  , 411.45834 , 421.875   , 432.2917  ,
       442.70834 ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 10 20 30 ... 21580 21590 21600</div><input id='attrs-9a5601db-3a35-4c52-8b21-1b6c9d945eff' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9a5601db-3a35-4c52-8b21-1b6c9d945eff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cb3c59e9-ab78-4349-919b-34bd9897e6b6' class='xr-var-data-in' type='checkbox'><label for='data-cb3c59e9-ab78-4349-919b-34bd9897e6b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd></dl></div><div class='xr-var-data'><pre>array([    0,    10,    20, ..., 21580, 21590, 21600])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>diam</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e-06</div><input id='attrs-9575157b-86bc-4ba7-b221-7d7722849258' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9575157b-86bc-4ba7-b221-7d7722849258' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c7f4b9b-ceb8-4dc7-9453-0f9a9933eb39' class='xr-var-data-in' type='checkbox'><label for='data-8c7f4b9b-ceb8-4dc7-9453-0f9a9933eb39' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd><dt><span>long_name :</span></dt><dd>Bin-middle particle diameter</dd></dl></div><div class='xr-var-data'><pre>array([1.e-06])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>T_C</span></div><div class='xr-var-dims'>(T)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-20.15 -20.05 ... -5.036 -4.18</div><input id='attrs-63657ccf-eb81-490a-a718-357b7ce2a91a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-63657ccf-eb81-490a-a718-357b7ce2a91a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f111766c-193a-4f07-a255-98517c8c4940' class='xr-var-data-in' type='checkbox'><label for='data-f111766c-193a-4f07-a255-98517c8c4940' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$° C$</dd></dl></div><div class='xr-var-data'><pre>array([-20.15      , -20.05      , -19.945     , -19.83475   ,
       -19.7189875 , -19.59743687, -19.46980872, -19.33579915,
       -19.19508911, -19.04734357, -18.89221075, -18.72932128,
       -18.55828735, -18.37870172, -18.1901368 , -17.99214364,
       -17.78425082, -17.56596336, -17.33676153, -17.09609961,
       -16.84340459, -16.57807482, -16.29947856, -16.00695249,
       -15.69980011, -15.37729012, -15.03865462, -14.68308736,
       -14.30974172, -13.91772881, -13.50611525, -13.07392101,
       -12.62011706, -12.14362292, -11.64330406, -11.11796926,
       -10.56636773,  -9.98718611,  -9.37904542,  -8.74049769,
        -8.07002258,  -7.3660237 ,  -6.62682489,  -5.85066613,
        -5.03569944,  -4.17998441])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height_km</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.005208 0.01562 ... 0.4323 0.4427</div><input id='attrs-168932fc-0ab2-4463-a068-cbd9316e8754' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-168932fc-0ab2-4463-a068-cbd9316e8754' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-72afb0e9-58b3-4184-8ed0-101aef4a0cbf' class='xr-var-data-in' type='checkbox'><label for='data-72afb0e9-58b3-4184-8ed0-101aef4a0cbf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$km$</dd></dl></div><div class='xr-var-data'><pre>array([0.00520833, 0.015625  , 0.02604167, 0.03645834, 0.046875  ,
       0.05729167, 0.06770834, 0.078125  , 0.08854167, 0.09895834,
       0.109375  , 0.11979167, 0.13020834, 0.140625  , 0.15104167,
       0.16145834, 0.171875  , 0.18229167, 0.19270834, 0.203125  ,
       0.21354167, 0.22395834, 0.234375  , 0.24479167, 0.25520834,
       0.265625  , 0.2760417 , 0.28645834, 0.296875  , 0.3072917 ,
       0.31770834, 0.328125  , 0.3385417 , 0.34895834, 0.359375  ,
       0.3697917 , 0.38020834, 0.390625  , 0.4010417 , 0.41145834,
       0.421875  , 0.4322917 , 0.44270834], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time_h</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.002778 0.005556 ... 5.997 6.0</div><input id='attrs-2a923e3d-cc02-49a3-963c-4df537c4e5c1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2a923e3d-cc02-49a3-963c-4df537c4e5c1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e4825edf-3f5a-452a-b3bf-eec393808331' class='xr-var-data-in' type='checkbox'><label for='data-e4825edf-3f5a-452a-b3bf-eec393808331' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$h$</dd></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 2.777778e-03, 5.555556e-03, ..., 5.994444e+00,
       5.997222e+00, 6.000000e+00])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>diam_um</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-949a01ff-23d1-466b-a157-475878b4e468' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-949a01ff-23d1-466b-a157-475878b4e468' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b1a811e8-5b2c-49ef-8137-27d6b14370a3' class='xr-var-data-in' type='checkbox'><label for='data-b1a811e8-5b2c-49ef-8137-27d6b14370a3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$\mu m$</dd></dl></div><div class='xr-var-data'><pre>array([1.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-40de9424-e390-4b5b-b019-79e2207bbeb4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-40de9424-e390-4b5b-b019-79e2207bbeb4' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>dn_dlogD</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([2.], &#x27;1 / liter&#x27;)&gt;</div><input id='attrs-50a22b64-a5a8-4311-8b95-f214e746bf39' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-50a22b64-a5a8-4311-8b95-f214e746bf39' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f0c10ee1-0666-4274-9679-5b3de7cc7e7d' class='xr-var-data-in' type='checkbox'><label for='data-f0c10ee1-0666-4274-9679-5b3de7cc7e7d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>Particle number concentration per diameter bin</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[2.0000000000000004]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>surf_area</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([3.14159265e-12], &#x27;met...</div><input id='attrs-c0f20182-521c-4bba-9fef-a34548c907bc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c0f20182-521c-4bba-9fef-a34548c907bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6f7c1809-59cd-441a-b4b5-fe730c67440e' class='xr-var-data-in' type='checkbox'><label for='data-6f7c1809-59cd-441a-b4b5-fe730c67440e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m^2$</dd><dt><span>long_name :</span></dt><dd>Surface area per particle diameter</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[3.141592653589793e-12]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter<sup>2</sup></td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ns_raw</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.00000000e+00 0.000...</div><input id='attrs-a4fb3d63-8782-4b0a-b3d7-3b4fefb27624' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a4fb3d63-8782-4b0a-b3d7-3b4fefb27624' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e35ebc86-b442-4904-9ca7-c641d5525351' class='xr-var-data-in' type='checkbox'><label for='data-e35ebc86-b442-4904-9ca7-c641d5525351' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>INAS ns-equivalent singular treatment</dd><dt><span>units :</span></dt><dd>$m^{-2}$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> [0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> [0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> ...<br> [7481182392.264709 7481182392.264709 7481182392.264709 ...<br>  7481182392.264709 7481182392.264709 7481182392.264709]<br> [7453528256.688641 7453528256.688641 7453528256.688641 ...<br>  7453528256.688641 7453528256.688641 7453528256.688641]<br> [7285677447.671117 7285677447.671117 7285677447.671117 ...<br>  7285677447.671117 7285677447.671117 7285677447.671117]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/meter<sup>2</sup></td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>inp</span></div><div class='xr-var-dims'>(height, time_h, T)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[[7.16660250e-06 1.17...</div><input id='attrs-e135499e-68b4-4d49-9400-b197f7906ba4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e135499e-68b4-4d49-9400-b197f7906ba4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e0c6a448-331c-4625-9b67-88b6abc9bd8b' class='xr-var-data-in' type='checkbox'><label for='data-e0c6a448-331c-4625-9b67-88b6abc9bd8b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>INP number concentration per temperature bin</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 0.0024480126867784968 0.002113967196932679 0.0034453361604091775]<br>  [7.166602500340959e-06 1.170559346732765e-05 1.6940818903299918e-05<br>   ... 0.002442003383747356 0.0021087778980565454 0.0034368786597010043]<br>  ...<br>  [7.166602500340959e-06 6.714600258604762e-06 5.577591595596773e-06 ...<br>   1.2213862592276089e-05 1.054721039942506e-05 1.7189805704322075e-05]<br>  [7.166602500340959e-06 6.712875489192066e-06 5.574732882566952e-06 ...<br>   1.2183910679938554e-05 1.052134559876086e-05 1.7147651344907494e-05]<br>  [7.166602500340959e-06 6.711151169423838e-06 5.571875653813761e-06 ...<br>   1.215403229296722e-05 1.0495544290501393e-05 1.7105600465186565e-05]]<br><br> [[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 0.0024480126867784968 0.002113967196932679 0.0034453361604091775]<br>  [7.166602500340959e-06 1.170559346732765e-05 1.6940818903299918e-05<br>   ... 0.002442003383747356 0.0021087778980565454 0.0034368786597010043]<br>  ...<br>  [7.166602500340959e-06 6.714600258604762e-06 5.577591595596773e-06 ...<br>   1.2213862592276089e-05 1.054721039942506e-05 1.7189805704322075e-05]<br>  [7.166602500340959e-06 6.712875489192066e-06 5.574732882566952e-06 ...<br>   1.2183910679938554e-05 1.052134559876086e-05 1.7147651344907494e-05]<br>  [7.166602500340959e-06 6.711151169423838e-06 5.571875653813761e-06 ...<br>   1.215403229296722e-05 1.0495544290501393e-05 1.7105600465186565e-05]]<br><br> [[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 0.0024480126867784968 0.002113967196932679 0.0034453361604091775]<br>  [7.166602500340959e-06 1.170559346732765e-05 1.6940818903299918e-05<br>   ... 0.002442003383747356 0.0021087778980565454 0.0034368786597010043]<br>  ...<br>  [7.166602500340959e-06 6.714600258604762e-06 5.577591595596773e-06 ...<br>   1.2213862592276089e-05 1.054721039942506e-05 1.7189805704322075e-05]<br>  [7.166602500340959e-06 6.712875489192066e-06 5.574732882566952e-06 ...<br>   1.2183910679938554e-05 1.052134559876086e-05 1.7147651344907494e-05]<br>  [7.166602500340959e-06 6.711151169423838e-06 5.571875653813761e-06 ...<br>   1.215403229296722e-05 1.0495544290501393e-05 1.7105600465186565e-05]]<br><br> ...<br><br> [[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 7.609446802437991e-06 6.571093774978339e-06<br>   1.0709545081504639e-05]<br>  [7.166602500340959e-06 1.170559346732765e-05 1.6940818903299918e-05<br>   ... 7.590767450961843e-06 6.554963329048122e-06<br>   1.0683255738544378e-05]<br>  ...<br>  [7.166602500340959e-06 6.714600258604762e-06 5.577591595596773e-06 ...<br>   3.799598253522237e-08 3.2811210958382756e-08 5.347559401383215e-08]<br>  [7.166602500340959e-06 6.712875489192066e-06 5.574732882566952e-06 ...<br>   3.790287984177581e-08 3.273081266594124e-08 5.334456116498481e-08]<br>  [7.166602500340959e-06 6.711151169423838e-06 5.571875653813761e-06 ...<br>   3.781000569499277e-08 3.265061173364917e-08 5.321384997300161e-08]]<br><br> [[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 7.609446802437991e-06 6.571093774978339e-06<br>   1.0709545081504639e-05]<br>  [7.166602500340959e-06 1.170559346732765e-05 1.6940818903299918e-05<br>   ... 7.590767450961843e-06 6.554963329048122e-06<br>   1.0683255738544378e-05]<br>  ...<br>  [7.166602500340959e-06 6.714600258604762e-06 5.577591595596773e-06 ...<br>   3.799598253522237e-08 3.2811210958382756e-08 5.347559401383215e-08]<br>  [7.166602500340959e-06 6.712875489192066e-06 5.574732882566952e-06 ...<br>   3.790287984177581e-08 3.273081266594124e-08 5.334456116498481e-08]<br>  [7.166602500340959e-06 6.711151169423838e-06 5.571875653813761e-06 ...<br>   3.781000569499277e-08 3.265061173364917e-08 5.321384997300161e-08]]<br><br> [[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 7.84372574226372e-06 6.773403998450057e-06 1.1039269558572653e-05]<br>  [7.166602500340959e-06 1.1705593756235357e-05 1.6940819739970718e-05<br>   ... 7.82504639078757e-06 6.757273552519838e-06 1.1012980215612394e-05]<br>  ...<br>  [7.166602500340959e-06 6.793613390026124e-06 5.760444127893078e-06 ...<br>   2.722749223609512e-07 2.351214344300996e-07 3.832000710818484e-07]<br>  [7.166602500340959e-06 6.791919167335606e-06 5.757638594525045e-06 ...<br>   2.721818196675046e-07 2.350410361376581e-07 3.8306903823300104e-07]<br>  [7.166602500340959e-06 6.790225386327496e-06 5.754834517826257e-06 ...<br>   2.7208894552072153e-07 2.3496083520536604e-07 3.829383270410178e-07]]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>inp_pct</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.         0.       ...</div><input id='attrs-6e3b6aa3-0c05-4a06-b0f2-1f325b786db7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6e3b6aa3-0c05-4a06-b0f2-1f325b786db7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-822270c2-b4ac-41f8-8a0e-dd83748ae0f6' class='xr-var-data-in' type='checkbox'><label for='data-822270c2-b4ac-41f8-8a0e-dd83748ae0f6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$percent$</dd><dt><span>long_name :</span></dt><dd>INP parameterization percentage relative to total initial aerosol</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> [0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> [0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> ...<br> [2.3502827643704127 2.3502827643704127 2.3502827643704127 ...<br>  2.3502827643704127 2.3502827643704127 2.3502827643704127]<br> [2.3415949614536973 2.3415949614536973 2.3415949614536973 ...<br>  2.3415949614536973 2.3415949614536973 2.3415949614536973]<br> [2.2888630746028418 2.2888630746028418 2.2888630746028418 ...<br>  2.2888630746028418 2.2888630746028418 2.2888630746028418]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>percent</td></tr></tbody></table></div></li></ul></div></li><li class='xr-section-item'><input id='section-fa6b86a9-a488-434e-a0b3-d95d41e58125' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fa6b86a9-a488-434e-a0b3-d95d41e58125' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p>When using ABIFM, we can see below how to print the ABIFM coefficient for a given aerosol population and where ABIFM coefficient tables are stored:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(&quot;m = %f, c = %f&quot; % (model_abifm.aer[&quot;Desert_Dust&quot;].Jhet.m, model_abifm.aer[&quot;Desert_Dust&quot;].Jhet.c))
model_abifm.aer[&quot;Desert_Dust&quot;].Jhet.Jhet_coeff_table
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
m = 22.620000, c = -1.350000
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>c</th>
      <th>sigma_c</th>
      <th>LCL_c</th>
      <th>UCL_c</th>
      <th>m</th>
      <th>sigma_m</th>
      <th>LCL_m</th>
      <th>UCL_m</th>
    </tr>
    <tr>
      <th>nucleus_type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ice nucleus</th>
      <td>c</td>
      <td>sigma_c</td>
      <td>LCL_c</td>
      <td>UCL_c</td>
      <td>m</td>
      <td>sigma_m</td>
      <td>LCL_m</td>
      <td>UCL_m</td>
    </tr>
    <tr>
      <th>N. atomus</th>
      <td>-17.12381</td>
      <td>0.27733</td>
      <td>-17.66751</td>
      <td>-16.5801</td>
      <td>83.95603</td>
      <td>1.17979</td>
      <td>81.64302</td>
      <td>86.26904</td>
    </tr>
    <tr>
      <th>T. pseudonana</th>
      <td>-10.4345</td>
      <td>0.17629</td>
      <td>-10.78012</td>
      <td>-10.08889</td>
      <td>59.66992</td>
      <td>0.79104</td>
      <td>58.11905</td>
      <td>61.22079</td>
    </tr>
    <tr>
      <th>Pahokee Peat</th>
      <td>-15.77884</td>
      <td>0.18337</td>
      <td>-16.13839</td>
      <td>-15.41929</td>
      <td>78.30951</td>
      <td>0.79777</td>
      <td>76.74529</td>
      <td>79.87374</td>
    </tr>
    <tr>
      <th>Leonardite</th>
      <td>-13.40148</td>
      <td>0.09931</td>
      <td>-13.59621</td>
      <td>-13.20675</td>
      <td>66.90259</td>
      <td>0.42911</td>
      <td>66.06118</td>
      <td>67.744</td>
    </tr>
    <tr>
      <th>Illite</th>
      <td>-10.66873</td>
      <td>0.07544</td>
      <td>-10.81666</td>
      <td>-10.5208</td>
      <td>54.48075</td>
      <td>0.33316</td>
      <td>53.8275</td>
      <td>55.134</td>
    </tr>
    <tr>
      <th>1-Nonadecanol</th>
      <td>-2.92414</td>
      <td>0.04322</td>
      <td>-3.00894</td>
      <td>-2.83934</td>
      <td>28.13797</td>
      <td>0.35129</td>
      <td>27.44871</td>
      <td>28.82723</td>
    </tr>
    <tr>
      <th>Kaolinite</th>
      <td>-10.54758</td>
      <td>0.38782</td>
      <td>-11.31377</td>
      <td>-9.7814</td>
      <td>54.58834</td>
      <td>1.39323</td>
      <td>51.8359</td>
      <td>57.34078</td>
    </tr>
    <tr>
      <th>Al2O3</th>
      <td>1.60671</td>
      <td>0.58271</td>
      <td>0.34784</td>
      <td>2.86558</td>
      <td>14.96639</td>
      <td>2.14742</td>
      <td>10.32717</td>
      <td>19.6056</td>
    </tr>
    <tr>
      <th>Fe2O3</th>
      <td>1.42411</td>
      <td>0.64593</td>
      <td>0.07672</td>
      <td>2.77149</td>
      <td>17.62106</td>
      <td>2.50034</td>
      <td>12.40544</td>
      <td>22.83668</td>
    </tr>
    <tr>
      <th>Fungal Spores</th>
      <td>0.97931</td>
      <td>1.29892</td>
      <td>-3.15444</td>
      <td>5.11306</td>
      <td>15.47856</td>
      <td>4.7061</td>
      <td>0.50162</td>
      <td>30.45549</td>
    </tr>
    <tr>
      <th>Desert Dust</th>
      <td>-1.35</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>22.62</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Feldspar (Herbert)</th>
      <td>-12.98</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>122.83</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>soot (Schill)</th>
      <td>-2.08</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>18.07</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Upper tropos, At., china</th>
      <td>0.66</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.98</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ACE-ENA gnd (Knopf)</th>
      <td>1.93</td>
      <td>0</td>
      <td>1.16</td>
      <td>2.7</td>
      <td>4.69</td>
      <td>0</td>
      <td>1.27</td>
      <td>8.11</td>
    </tr>
    <tr>
      <th>Fluka Kaolinite (Wex)</th>
      <td>-8.61</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>53.32</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As mentioned above, we can also use xarray to examine the model output. While we can still use the two model objects from above, let us initialize two additional simulations using the model’s default PSD (<span class="math notranslate nohighlight">\(D_{mean}\ =\ 1\ \mu m\)</span>, SD = 2.5, 35 PSD bins, <span class="math notranslate nohighlight">\(D_{min}\ =\ 0.01\ \mu m\)</span>, and bin mass ratio of 2). Here, we use 6 h long model run (note that run_model=False so the model only initializes). in the first simulation, the LES sounding we use represents the simulation mean between 3-6
h (after steady state), while in the second we inform the model with the full (un-averaged) prognosed LES output. Note that ABIFM, LES output temporal averaging, and the PSD parameters are all used by default, so these can be specified when calling the model, but are not required in this case. Note that in both simulations we specified the mixing layer as only occurring within cloud boundaries (see figures below).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from init_model import ci_model

# Average LES in time
model_def = ci_model(final_t=3600*6,                           # 1D model simulation time
                 mixing_bounds=(&quot;ql_thresh&quot;, &quot;ql_thresh&quot;),     # Mixing layer bounds (base, top) in m (&quot;ql_thresh&quot; for cloud base/top)
                 aer_info=[{&quot;name&quot;: &quot;DesertDust_default&quot;,      # Aerosol population properties
                            &quot;n_init_max&quot;: 1.5,
                            &quot;psd&quot;: {&quot;type&quot;: &quot;default&quot;},
                            &quot;nucleus_type&quot;: &quot;Desert Dust&quot;}
                          ],
                 t_harvest=(3600*3, 3600*6),                   # time(s) to harvest from the LES model output
                 run_model=False)

# Use full LES output to inform the model
model_def_no_les_ave =   ci_model(final_t=3600*6,                      # 1D model simulation time
                         mixing_bounds=(&quot;ql_thresh&quot;, &quot;ql_thresh&quot;),     # Mixing layer bounds (base, top) in m (&quot;ql_thresh&quot; for cloud base/top)
                         t_averaged_les=False,                         # True - time-averaged LES, False - LES evolution informs 1d model
                         aer_info=[{&quot;name&quot;: &quot;DesertDust_default&quot;,      # Aerosol population #4 properties
                                    &quot;n_init_max&quot;: 1.5,
                                    &quot;psd&quot;: {&quot;type&quot;: &quot;default&quot;},
                                    &quot;nucleus_type&quot;: &quot;Desert Dust&quot;}
                                  ],
                         t_harvest=(0, 3600*6),                        # time(s) to harvest from the LES model output
                         run_model=False)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model initalization done! Total processing time = 2.412551 s
Model initalization done! Total processing time = 3.035274 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = model_def_no_les_ave.generate_figure(subplot_shape=(2,1))
model_def.ds[&quot;mixing_mask&quot;].plot(ax=ax[0])
model_def_no_les_ave.ds[&quot;mixing_mask&quot;].plot(ax=ax[1])
fig.tight_layout()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_18_0.png" src="_images/Example_18_0.png" />
</div>
</div>
<p>The simulation below shows all model input options and capabilities of handling multiple aerosol populations that can be weighted vertically (introducing aerosol layers). Note that if weights larger than 1 are specified, the weight profile is normalized to have a maximum value of 1 (a message is printed on the screen to let the user know). In this simulation we use the full LES output, and specify 5 INP populations of different types (nucleus type, PSD, etc.). Here, our mixed layer goes from the
surface up to cloud top and note that we use again the option of specifying the input parameters in non-SI units.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from init_model import ci_model
import numpy as np

model = ci_model(final_t=3600*4,                               # 1D model simulation time
                 delta_t=10,                                   # ∆t in s
                 use_ABIFM=True,                               # True - ABIFM, False - singular
                 t_averaged_les=False,                         # True - time-averaged LES, False - LES evolution informs 1d model
                 custom_vert_grid=np.arange(0., 500.+1., 10.), # None - use LES vertical grid, np.ndarray - custom vertical grid
                 w_e_ent=0.1e-3,                               # cloud-top entrainment value or time series
                 mixing_bounds=(0, &quot;ql_thresh&quot;),               # Mixing layer bounds (base, top) in m (&quot;ql_thresh&quot; for cloud base/top)
                 deplete_entrained=True,                       # True - deplete aerosol from top, False -infinite (subsidising) entrainment source
                 tau_mix=1800.,                                # Mixing time scale value or time series
                 v_f_ice=0.3,                                  # number-weighted fall velocity (value, t-series, or curtain)
                 in_cld_q_thresh=1e-6,                         # mixing ratio threshold for determining a cloud [kg/kg]
                 aer_info=[{&quot;name&quot;: &quot;Illite_mono&quot;,             # Aerosol population #1 properties
                            &quot;n_init_max&quot;: 2.,
                            &quot;psd&quot;: {&quot;type&quot;: &quot;mono&quot;,
                                   &quot;diam&quot;: 1.},
                            &quot;nucleus_type&quot;: &quot;Illite&quot;,
                            &quot;n_init_weight_prof&quot;:
                            {&quot;height&quot;: np.array([0, 100, 150, 200, 500]),
                            &quot;weight&quot;: np.array([0.8, 1., 1., 0.2, 0.1])}},
                           {&quot;name&quot;: &quot;Kaolinite&quot;,               # Aerosol population #2 properties
                            &quot;n_init_max&quot;: 1.5,
                            &quot;psd&quot;: {&quot;type&quot;: &quot;logn&quot;,
                                    &quot;diam_mean&quot;: 0.8,
                                    &quot;geom_sd&quot;: 1.5,
                                    &quot;n_bins&quot;: 40,
                                    &quot;diam_min&quot;: 0.05,
                                    &quot;m_ratio&quot;: 1.5},
                            &quot;nucleus_type&quot;: &quot;Kaolinite&quot;},
                           {&quot;name&quot;: &quot;Al2O3_default&quot;,            # Aerosol population #3 properties
                            &quot;n_init_max&quot;: 1.5,
                            &quot;psd&quot;: {&quot;type&quot;: &quot;default&quot;},
                            &quot;nucleus_type&quot;: &quot;Al2O3&quot;,
                            &quot;n_init_weight_prof&quot;:
                            {&quot;height&quot;: np.array([0, 300, 350, 400, 500]),
                            &quot;weight&quot;: np.array([0., 0.1, 1.0, 1.0, 0.1])}},
                           {&quot;name&quot;: &quot;DesertDust&quot;,               # Aerosol population #4 properties
                            &quot;n_init_max&quot;: [4329777, 640],
                            &quot;psd&quot;: {&quot;type&quot;: &quot;multi_logn&quot;,
                                    &quot;diam_mean&quot;: [0.0744, 2.251],
                                    &quot;geom_sd&quot;: [1.76, 1.6],
                                    &quot;n_bins&quot;: 50,
                                    &quot;diam_min&quot;: (0.014, 20),
                                    &quot;m_ratio&quot;: 1.5},
                            &quot;nucleus_type&quot;: &quot;Desert Dust&quot;},
                           {&quot;name&quot;: &quot;Al2O3_custom&quot;,            # Aerosol population #5 properties
                            &quot;n_init_max&quot;: 1,
                            &quot;psd&quot;: {&quot;type&quot;: &quot;custom&quot;,
                                    &quot;diam&quot;: [0.1, 0.3, 1., 2., 10.],
                                    &quot;dn_dlogD&quot;: [0.2, 0.1, 0.6, 0.1, 0.05],
                                    &quot;norm_to_n_init_max&quot;: True},
                            &quot;nucleus_type&quot;: &quot;Al2O3&quot;}
                            ],
                 les_out_path=None,                            # path of LES output sounding file to inform the model
                 les_out_filename=None,                        # filename of LES sounding file to inform the model
                 t_harvest=(0, 3600*6),                        # time(s) to harvest from the LES model output
                 height_ind_2crop=600.,                        # height indices or vals for LES cropping (&quot;ql_pbl&quot;: use ql thresh)
                 cbh_det_method=&quot;ql_thresh&quot;,                   # Method to detect cloud base (currently, only with a ql thresh)
                 input_conc_units=&quot;L^{-1}&quot;,                    # Specify alternative input concentartion units
                 input_diam_units=&quot;um&quot;,                        # Specify alternative input diameter units
                 do_entrain=True,                              # do entrainment in model run
                 do_mix_aer=True,                              # do aerosol mixing in model run
                 do_mix_ice=True,                              # do ice mixing in model run
                 do_sedim=True,                                # do sedimentation in model run
                 run_model=True)                               # True - run model after initialization
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Some heights were omitted because they are outside the processed LES dataset grid
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;dn_dlogD&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;diam&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
&#39;diam_mean&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
&#39;diam_min&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
&#39;diam_mean&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
&#39;diam_min&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
&#39;diam&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
Model initalization done! Total processing time = 2.400986 s
10% of model run completed. Elapsed time: 1.40 s.
20% of model run completed. Elapsed time: 2.81 s.
30% of model run completed. Elapsed time: 4.23 s.
40% of model run completed. Elapsed time: 5.65 s.
50% of model run completed. Elapsed time: 7.06 s.
60% of model run completed. Elapsed time: 8.48 s.
70% of model run completed. Elapsed time: 9.93 s.
80% of model run completed. Elapsed time: 11.35 s.
90% of model run completed. Elapsed time: 12.76 s.

Model run finished! Total run time = 14.261499 s
Model run time stats:
Process: activation_aer: 2.76 s (19.37% of of total time)
Process: entrainment_aer: 1.24 s (8.69% of of total time)
Process: mixing_aer: 2.83 s (19.82% of of total time)
Process: sedimentation_ice: 0.33 s (2.31% of of total time)
Process: mixing_ice: 0.33 s (2.32% of of total time)
Process: data_allocation: 6.67 s (46.76% of of total time)


</pre></div></div>
</div>
<p>Let’s plot curtain plots of the model output for the INP population we named: “Al2O3_default” (again, we convert the output units and some coordinates for convenience; note that requested coordinate values were adjusted accordignly). Here, we show the population’s Jhet (depends on nucleus type and RH + T from the LES), temporal evolution of the INP PSD at an altitude of 400 m (in-cloud), and the PSD profiles at initialization (t = 0 s) and 1 h into the simulation. Note the layer structure of the
population at initialization as we used vertical weighting).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>model._convert_quantity_units(&quot;L^{-1}&quot;)
model._convert_quantity_units(&quot;L^{-1}&quot;)
model._convert_quantity_units(&quot;cm^{-2} s^{-1}&quot;)
model._swap_time_dim_to_from_hr()
model._swap_height_dim_to_from_km()
model._swap_diam_dim_to_from_um()

cb = {}
fig, ax = model.generate_figure(subplot_shape=(2,2))
ax[0,0], cb[&quot;sub0&quot;] = model.plot_curtain(ax=ax[0,0], which_pop=&quot;Al2O3_default&quot;, field_to_plot=&quot;Jhet&quot;, font_size=20, vmin=0, title=&quot;Jhet for Al2O3_default&quot;)
ax[0,1], cb[&quot;sub1&quot;] = model.plot_curtain(ax=ax[0,1], which_pop=&quot;Al2O3_default&quot;, font_size=20, x=model.diam_dim, y=model.time_dim, aer_z=0.4, title=&quot;h = 400 m for Al2O3_default&quot;)
ax[1,0], cb[&quot;sub2&quot;] = model.plot_curtain(ax=ax[1,0], which_pop=&quot;Al2O3_default&quot;, font_size=20, x=model.diam_dim, aer_z=0., title=&quot;t = 0 h for Al2O3_default&quot;)
ax[1,1], cb[&quot;sub3&quot;] = model.plot_curtain(ax=ax[1,1], which_pop=&quot;Al2O3_default&quot;, font_size=20, x=model.diam_dim, aer_z=1.,xscale=&quot;log&quot;, title=&quot;t = 1 h for Al2O3_default&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The units of &#39;Ni&#39; converted from $L^{-1}$ to L^{-1}
The units of &#39;Ni_nuc&#39; converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Illite_mono&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Illite_mono&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Kaolinite&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Kaolinite&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Al2O3_default&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Al2O3_default&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;DesertDust&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;DesertDust&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Al2O3_custom&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Al2O3_custom&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;Ni&#39; converted from $L^{-1}$ to L^{-1}
The units of &#39;Ni_nuc&#39; converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Illite_mono&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Illite_mono&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Kaolinite&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Kaolinite&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Al2O3_default&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Al2O3_default&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;DesertDust&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;DesertDust&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Al2O3_custom&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Al2O3_custom&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;Jhet&#39; in the &#39;Illite_mono&#39; popolation converted from $cm^{-2} s^{-1}$ to cm^{-2} s^{-1}
The units of &#39;Jhet&#39; in the &#39;Kaolinite&#39; popolation converted from $cm^{-2} s^{-1}$ to cm^{-2} s^{-1}
The units of &#39;Jhet&#39; in the &#39;Al2O3_default&#39; popolation converted from $cm^{-2} s^{-1}$ to cm^{-2} s^{-1}
The units of &#39;Jhet&#39; in the &#39;DesertDust&#39; popolation converted from $cm^{-2} s^{-1}$ to cm^{-2} s^{-1}
The units of &#39;Jhet&#39; in the &#39;Al2O3_custom&#39; popolation converted from $cm^{-2} s^{-1}$ to cm^{-2} s^{-1}
Converting time dimension units from seconds to hours
Converting height dimension units from meters to kilometers
Converting diameter dimension units for Illite_mono from meters to micrometers
Converting diameter dimension units for Kaolinite from meters to micrometers
Converting diameter dimension units for Al2O3_default from meters to micrometers
Converting diameter dimension units for DesertDust from meters to micrometers
Converting diameter dimension units for Al2O3_custom from meters to micrometers
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_22_1.png" src="_images/Example_22_1.png" />
</div>
</div>
<p>We can also produce time series of different variables at specific heights, for example (note that here we customize the plots by specifying the x-axis label, xticks, and xlim input parameters available, among other optional parameters, in the internal plotting methods).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>xticks = np.linspace(0, 2, 5)
XLim = [0, 2]
Height=[0.2, 0.3, 0.4]
fig, ax = model.generate_figure(subplot_shape=(2,2))
ax[0,0] = model.plot_tseries(ax=ax[0,0], font_size=20, field_to_plot=&quot;Ni_nuc&quot;, Height=Height, xlabel=&quot;time [h]&quot;, xtick=xticks, xlim=XLim, Height_dim_treat=None, title=&quot;Total ice number concentration&quot;)
ax[0,1] = model.plot_tseries(ax=ax[0,1], font_size=20, field_to_plot=&quot;nuc_rate&quot;, Height=Height, xlabel=&quot;time [h]&quot;, xtick=xticks, xlim=XLim, yscale=&quot;log&quot;, Height_dim_treat=None, title=&quot;Total nucleation rate&quot;)
ax[1,0] = model.plot_tseries(ax=ax[1,0], which_pop=&quot;Al2O3_default&quot;, Height=Height, font_size=20, xlabel=&quot;time [h]&quot;, xtick=xticks, xlim=XLim, Height_dim_treat=None, title=&quot;Aerosol concentration for &#39;Al2O3_default&#39;&quot;)
ax[1,1] = model.plot_tseries(ax=ax[1,1], which_pop=&quot;Al2O3_default&quot;, Height=Height, font_size=20, xlabel=&quot;time [h]&quot;, xtick=xticks, xlim=XLim, linewidth=3, title=&quot;mean aerosol conc. (for &#39;Al2O3_default&#39; at 3 heights)&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_24_0.png" src="_images/Example_24_0.png" />
</div>
</div>
<p>Profile plots can also be generated using the internal methods at different times. In the example below to the right, a simulation average profile of total INP concentration for each of the INP populations is shown (note that dn_dlogD is summed over all diameters in each population).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>Times = [0., 0.5, 1., 4.]
fig, ax = model.generate_figure(subplot_shape=(1,4), figsize=(14,5))
ax[0] = model.plot_profile(ax=ax[0], field_to_plot=&quot;Ni_nuc&quot;, Time=Times, Time_dim_treat=None)
ax[1] = model.plot_profile(ax=ax[1], field_to_plot=&quot;nuc_rate&quot;, xscale=&quot;log&quot;, Time=Times, Time_dim_treat=None)
ax[2] = model.plot_profile(ax=ax[2], field_to_plot=&quot;T&quot;, Time=Times, Time_dim_treat=None)
ax[3] = model.plot_profile(ax=ax[3], which_pop=&quot;Al2O3_default&quot;)
ax[3] = model.plot_profile(ax=ax[3], which_pop=&quot;Al2O3_custom&quot;)
ax[3] = model.plot_profile(ax=ax[3], which_pop=&quot;Kaolinite&quot;)
ax[3] = model.plot_profile(ax=ax[3], which_pop=&quot;Illite_mono&quot;, legend=True)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_26_0.png" src="_images/Example_26_0.png" />
</div>
</div>
<p>Finally, let’s perform three simulations using the three available approaches (ABIFM, INAS, and singular), and briefly examine their operation. The simualtions are initialized identically (hence we define the input paramters before calling the generation of the ci_model class), and represent real PSD of desert dust (from the SGP site; obviously, these elevated values do not match the Arctic case harvested from the LES).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from init_model import ci_model
import numpy as np

delta_t = 10  # time setp
aer_info = [{&quot;name&quot;: &quot;DesertDust&quot;,             # INP population #1 properties
             &quot;n_init_max&quot;: [4329777e3, 640e3], # SGP 10/15 PM
             &quot;psd&quot;: {&quot;type&quot;: &quot;multi_logn&quot;,
                     &quot;diam_mean&quot;: [0.0744e-6, 2.251e-6],
                     &quot;geom_sd&quot;: [1.76, 1.6],
                     &quot;n_bins&quot;: 50,
                     &quot;diam_min&quot;: (0.014e-6, 20e-6),
                     &quot;m_ratio&quot;: 1.5},
            &quot;nucleus_type&quot;: &quot;Desert Dust&quot;}]
t_averaged_les=False
custom_vert_grid=np.arange(0., 500.+1., 10.) # Custom vertical grid with 10 m vertical resolution
height_ind_2crop=600.  # max height to grab from the LES
mixing_bounds=(0, &quot;ql_thresh&quot;)  # coupled cloud - mixing from surface to cloud top
t_harvest=(3600, 3600*3)  # starting 1 h after beginning of LES (steady-state)

# ABIFM
abifm_sgp_mix = ci_model(use_ABIFM=True,
                     delta_t=delta_t,
                     t_averaged_les=t_averaged_les,
                     custom_vert_grid=custom_vert_grid,
                     aer_info=aer_info,
                     height_ind_2crop=height_ind_2crop,
                     mixing_bounds=mixing_bounds,
                     t_harvest=t_harvest)

# Singular (DeMott et al., 2015)
singular_sgp_mix = ci_model(use_ABIFM=False,
                     delta_t=delta_t,
                     t_averaged_les=t_averaged_les,
                     custom_vert_grid=custom_vert_grid,
                     aer_info=[{**aer_info[0], **{&quot;singular_fun&quot;: &quot;D2015&quot;}}],  # DeMott et al., 2015
                     height_ind_2crop=height_ind_2crop,
                     mixing_bounds=mixing_bounds,
                     t_harvest=t_harvest)

# INAS (Niemand et al., 2012)
inas_sgp_mix = ci_model(use_ABIFM=False,
                     delta_t=delta_t,
                     t_averaged_les=t_averaged_les,
                     custom_vert_grid=custom_vert_grid,
                     aer_info=[{**aer_info[0], **{&quot;singular_fun&quot;: &quot;ND2012&quot;}}],  # Niemand et al., 2012
                     height_ind_2crop=height_ind_2crop,
                     mixing_bounds=mixing_bounds,
                     t_harvest=t_harvest)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Some heights were omitted because they are outside the processed LES dataset grid
Model initalization done! Total processing time = 2.782583 s
10% of model run completed. Elapsed time: 0.64 s.
20% of model run completed. Elapsed time: 1.28 s.
30% of model run completed. Elapsed time: 1.91 s.
40% of model run completed. Elapsed time: 2.55 s.
50% of model run completed. Elapsed time: 3.18 s.
60% of model run completed. Elapsed time: 3.82 s.
70% of model run completed. Elapsed time: 4.45 s.
80% of model run completed. Elapsed time: 5.09 s.
90% of model run completed. Elapsed time: 5.72 s.

Model run finished! Total run time = 6.408056 s
Model run time stats:
Process: activation_aer: 0.88 s (13.68% of of total time)
Process: entrainment_aer: 0.51 s (7.90% of of total time)
Process: mixing_aer: 0.93 s (14.54% of of total time)
Process: sedimentation_ice: 0.50 s (7.73% of of total time)
Process: mixing_ice: 0.50 s (7.78% of of total time)
Process: data_allocation: 3.04 s (47.47% of of total time)


Some heights were omitted because they are outside the processed LES dataset grid
Model initalization done! Total processing time = 2.718077 s
10% of model run completed. Elapsed time: 0.58 s.
20% of model run completed. Elapsed time: 1.24 s.
30% of model run completed. Elapsed time: 1.86 s.
40% of model run completed. Elapsed time: 2.45 s.
50% of model run completed. Elapsed time: 3.03 s.
60% of model run completed. Elapsed time: 3.61 s.
70% of model run completed. Elapsed time: 4.20 s.
80% of model run completed. Elapsed time: 4.78 s.
90% of model run completed. Elapsed time: 5.40 s.

Model run finished! Total run time = 6.064351 s
Model run time stats:
Process: activation_aer: 1.18 s (19.44% of of total time)
Process: entrainment_aer: 0.55 s (9.04% of of total time)
Process: mixing_aer: 1.20 s (19.81% of of total time)
Process: sedimentation_ice: 0.49 s (8.05% of of total time)
Process: mixing_ice: 0.52 s (8.49% of of total time)
Process: data_allocation: 2.08 s (34.28% of of total time)


Some heights were omitted because they are outside the processed LES dataset grid
Model initalization done! Total processing time = 2.722860 s
10% of model run completed. Elapsed time: 1.99 s.
20% of model run completed. Elapsed time: 3.95 s.
30% of model run completed. Elapsed time: 5.98 s.
40% of model run completed. Elapsed time: 7.95 s.
50% of model run completed. Elapsed time: 9.91 s.
60% of model run completed. Elapsed time: 11.88 s.
70% of model run completed. Elapsed time: 13.83 s.
80% of model run completed. Elapsed time: 15.79 s.
90% of model run completed. Elapsed time: 17.78 s.

Model run finished! Total run time = 19.844750 s
Model run time stats:
Process: activation_aer: 3.48 s (17.56% of of total time)
Process: entrainment_aer: 1.12 s (5.64% of of total time)
Process: mixing_aer: 7.20 s (36.30% of of total time)
Process: sedimentation_ice: 0.51 s (2.59% of of total time)
Process: mixing_ice: 0.53 s (2.67% of of total time)
Process: data_allocation: 6.86 s (34.58% of of total time)


</pre></div></div>
</div>
<p>When using INAS, <span class="math notranslate nohighlight">\(n_s(T)\)</span> is first calculated for all the values in the temperature array, determined such that the smallest temperature represents the minimum temeprature over the entire height x time LES model output (<span class="math notranslate nohighlight">\(T_{min}\)</span>), and the largest temeprature represents a temperature just above -5 C (the array bins are calcualted using an increasing bin width following a geometric progression). INP concentrations are then allocated by multiplying <span class="math notranslate nohighlight">\(n_s(T)\)</span> by the surface area of
all aerosols per diameter bin and recursively subtracting the sum of <span class="math notranslate nohighlight">\(n_s(T &gt; T_i)\)</span> from <span class="math notranslate nohighlight">\(n_s(T_i)\)</span>, where <span class="math notranslate nohighlight">\(i\)</span> designates a temperature bin, such that <span class="math notranslate nohighlight">\(\sum_{i=1}^{i=N_T} n_s(T_i)=n_s(T_{min})\)</span>, where <span class="math notranslate nohighlight">\(N_T\)</span> is the number of temperature bins. The “inp_init” field saves the initial INP height x diameter x time distribution and is shown below for a height of 400 m, where the temperature is very close to <span class="math notranslate nohighlight">\(T_{min}\)</span>. At every time step (<span class="math notranslate nohighlight">\(t\)</span>) at a given level
<span class="math notranslate nohighlight">\(h\)</span>, all allocated INP associated with <span class="math notranslate nohighlight">\(T &gt; T_{LES}(h,t)\)</span> (<span class="math notranslate nohighlight">\(T_{LES}(h,t)\)</span> is the temperature harvested from the LES output) are consumed (summed over all temperature bins, resulting in a height x diameter array) and subtracted from the total aerosol concentration array <span class="math notranslate nohighlight">\(N_{aer}(h,t,D)\)</span>, allowing direct comparison with the <span class="math notranslate nohighlight">\(N_{aer}(h,t,D)\)</span> array from ABIFM, while maintaining full consistency with the aerosol surface area and temperature dependencies of the INAS
<span class="math notranslate nohighlight">\(n_s\)</span> approach.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>inas_sgp_mix.aer[&quot;DesertDust&quot;].ds[&quot;inp_init&quot;].sel({&quot;height&quot;: 400.}, method=&quot;nearest&quot;).plot(x=&quot;diam&quot;,xscale=&quot;log&quot;, cmap=&quot;plasma&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/meteo/ixs34/.conda/envs/emc2/lib/python3.7/site-packages/xarray/core/variable.py:262: UnitStrippedWarning: The unit of the quantity is stripped when downcasting to ndarray.
  data = data.get() if isinstance(data, cupy_array_type) else np.asarray(data)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.QuadMesh at 0x7fd92fce8090&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_30_2.png" src="_images/Example_30_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="index.html"
                          title="Previous page">&larr; Welcome to the Aerosol-Cloud Column Model (AC-1D) documentation!</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Example.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="index.html" title="Welcome to the Aerosol-Cloud Column Model (AC-1D) documentation!"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="index.html">Aerosol-Cloud Column Model (AC-1D)  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Model Run Examples and Output Notebook</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2022, Israel Silber, Ann Fridlind.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>